@page "{id}"
@model SGID.Pages.DashBoards.DashBoardModel
@{
    ViewData["Title"] = "DASHBOARD";
    if (User.IsInRole("Admin"))
    {
        Layout = "_LayoutNovo";
    }
    else if (User.IsInRole("Diretoria"))
    {
        Layout = "_LayoutDiretoria";
    }
    else
    {
        Layout = "_LayoutNovo";
    }
}

<!--<div id="piechart" style="width: 900px; height: 500px;"></div>-->
@Html.AntiForgeryToken()

<!-- Campo de Pesquisa-->
<div class="row">
    <div class="offset-4 offset-sm-4 offset-4 col-md-3 col-sm-3 col-3">
        <input class="form-control" type="search" id="searchInput" name="searchInput" oninput="this.value = this.value.toUpperCase()" />
    </div>
    <div class="offset-2 offset-sm-2 offset-2 col-md-3 col-sm-3 col-3">
        <a href="/cirurgias/novoagendamento/03" class="float-end" style="text-decoration:none;"><i class="fa-regular fa-calendar-days"></i> Novo Orçamento</a>
    </div>
</div>
<br />

<!-- Cards -->
<div class="row justify-content-center col-12 col-sm-12 col-md-12 col-xl-12">
    <div class="col-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:black" class="panel-title text-center">TOTAL DE COTAÇÔES</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                <a class="produto" href="/dashboards/dashboard/0"><h3 class="text-center" style="margin-top:0%; color:black;font-size:80px">@Model.Total</h3></a>
            </div>
        </div>
    </div>
    <div class="col-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;" class="panel-title text-center">NÃO RESPONDIDAS</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                <a class="produto" href="/dashboards/dashboard/3"><h3 class="text-center" style="margin-top:0%;font-size:80px">@Model.NRespondidas</h3></a>
            </div>
        </div>
    </div>
    <div class="col-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:#c00000" class="panel-title text-center">PENDENTE COMERCIAL</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                <a class="produto" href="/dashboards/dashboard/1"><h3 class="text-center" style="margin-top:0%; color:#c00000;font-size:80px">@Model.PendenteComercial</h3></a>
            </div>
        </div>
    </div>
    <div class="col-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;" class="panel-title text-center">RESPONDIDO PELO COMERCIAL</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                <a class="produto" href="/dashboards/dashboard/7"><h3 class="text-center" style="margin-top:0%;font-size:80px">@Model.Respondidas</h3></a>
            </div>
        </div>
    </div>
    <div class="col-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:#00b050" class="panel-title text-center">PENDENTE CLIENTE</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                <a class="produto" href="/dashboards/dashboard/2"><h3 class="text-center" style="margin-top:0%; color:#00b050;font-size:80px">@Model.RetornoCliente</h3></a>
            </div>
        </div>
    </div>
    <div class="col-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:#00b050" class="panel-title text-center">APROVADAS</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                <a class="produto" href="/dashboards/dashboard/4"><h3 class="text-center" style="margin-top:0%; color:#00b050;font-size:80px">@Model.Aprovadas</h3></a>
            </div>
        </div>
    </div>
    <div class="col-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;" class="panel-title text-center">PERDIDAS</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                <a class="produto" href="/dashboards/dashboard/5"><h3 class="text-center" style="margin-top:0%; font-size:80px">@Model.Perdidas</h3></a>
            </div>
        </div>
    </div>
    <div class="col-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:#c00000" class="panel-title text-center">EMERGÊNCIA</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                <a class="produto" href="/dashboards/dashboard/6"><h3 class="text-center" style="margin-top:0%; color:#c00000;font-size:80px">@Model.Emergencia</h3></a>
            </div>
        </div>
    </div>
</div>

<!--Tabela-->
<div class="col-12 col-sm-12 col-md-12">
    <div class="panel">
        <div class="panel-body">
            <table id="demo-dt-addrow" class="table table-striped table-bordered" cellspacing="0" width="50%">
                <thead>
                    <tr>
                        <th class="text-center">
                            COD. SOLICITAÇÃO
                        </th>
                        <th class="text-center">
                            PACIENTE
                        </th>
                        <th class="text-center">
                            DATA CIRURGIA
                        </th>
                        <th class="text-center">
                            CLIENTE
                        </th>
                        <th class="text-center">
                            CLIENTE DE ENTREGA
                        </th>
                        <th class="text-center">
                            NOME DO MEDICO
                        </th>
                        <th class="text-center">
                            NOME DO PROCEDIMENTO
                        </th>
                        <th class="text-center">
                            STATUS PEDIDO
                        </th>
                        <th class="text-center">
                            VENDEDOR
                        </th>
                        <th class="text-center">
                            DATA ALTERAÇÃO
                        </th>
                        <th class="text-center">
                            AÇÃO
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var data in Model.Agendamentos)
                    {
                        <tr>
                            <td>@data.Id</td>
                            <td>@Html.DisplayFor(model => data.Paciente)</td>
                            <td>
                                @if (data.DataCirurgia == null)
                                {
                                    <span>NÃO DATA REGISTRADA</span>
                                }
                                else
                                {
                                    <span>@data.DataCirurgia.Value.ToString("dd/MM/yyyy HH:mm")</span>
                                }
                            </td>
                            <td>@Html.DisplayFor(model => data.Cliente)</td>
                            <td>@Html.DisplayFor(model => data.Hospital)</td>
                            <td>@Html.DisplayFor(model => data.Medico)</td>
                            <td>@Html.DisplayFor(model => data.Procedimento)</td>
                            @if (data.StatusPedido == 0)
                            {
                                <td>Não enviado para cotação</td>
                            }
                            else if (data.StatusPedido == 1)
                            {
                                <td>Ag. Cotação</td>
                            }
                            else if (data.StatusPedido == 2)
                            {
                                <td>Pendente Comercial</td>
                            }
                            else if (data.StatusPedido == 3)
                            {
                                <td>Aprovado</td>
                            }
                            else if (data.StatusPedido == 4)
                            {
                                <td>Perdida</td>
                            }
                            else if (data.StatusPedido == 6)
                            {
                                <td>Retorno Cliente</td>
                            }
                            else
                            {
                                <td>Confirmado</td>
                            }
                            <td>@data.Vendedor</td>
                            <td>@data.DataAlteracao.ToString("dd/MM/yyyy HH:mm")</td>
                            <td>
                                <a class="details" data-id="@data.Id" data-toggle="modal" data-target="#details-modal"><i class="fa-solid fa-paper-plane"></i></a>
                                <a class="produto" href="/cirurgias/editaragendamento/@data.Id"><i class="fa-solid fa-pen"></i></a>
                                @if (data.StatusPedido != 4)
                                {
                                    <a class="rejeicao" data-id="@data.Id"><i class="fa-regular fa-circle-xmark" style="color:red"></i></a>
                                }
                                @if (data.DataCirurgia != null && data.StatusPedido != 3)
                                {
                                    <a onclick="aceite(@data.Id)"><i class="fa-regular fa-circle-check" style="color:green"></i></a>
                                }
                                <a onclick="dados(@data.Id)" class="fas fa-eye add-tooltip" style="text-decoration:none;" data-container="body" data-placement="top" data-original-title="Visualizar Cotação" aria-hidden="true"></a>
                                <a href="/cirurgias/pdfagendamento/@data.Id" target="_blank" onClick="windows"><i class="fa-solid fa-file-pdf"></i></a>
                                @if (data.StatusPedido == 4)
                                {
                                    <a class="MotivoRej" data-id="@data.Id"><i class="fa-solid fa-bars" style="text-decoration:none;" data-container="body" data-placement="top" data-original-title="Motivo Rejeição" aria-hidden="true"></i></a>
                                }
                                <a class="duplicar" data-id="@data.Id" data-toggle="modal" data-target="#duplicar-modal"><i class="fa-solid fa-copy"></i></a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>
<!--Detalhes-->
<div class="modal fade" id="details-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <input hidden id="Idd" />
                <div class="col-md-5">
                    <div class="col-md-12" style="color:#c00000"><b>Cotação: Nº <span id="NumCota"></span></b></div>
                    <div class="col-md-12"><b>Status:</b> <span id="Status"></span></div>
                </div>
                <div class="col-md-3 offset-2">
                    <div class="col-md-12"><b>Tipo:</b> Manual</div>
                    <div class="col-md-12"><b>Data:</b> <span id="DataCriacao"></span></div>
                </div>
                <div class="col-md-1">
                    <a class="close" data-dismiss="modal"><i class="fa-regular fa-circle-xmark" style="color:red"></i></a>
                </div>
            </div>

            <!--Modal body-->
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12"><b>Informações gerais</b></div>
                    <!--<div class="col-md-12"> Quantidade de Fornecedores Participantes: 2</div>
                    <div class="col-md-12"> Quantidade de Fornecedores que responderam a cotação: 2</div>
                    <div class="col-md-12"> Dias desde a abertura até o encerramento: 8</div>-->
                </div>
                <div class="row">
                    <div class="col-md-12"><b>Resultados da Cotação</b></div>
                    <div class="col-md-12">
                    </div>
                </div>
            </div>

            <!--Modal footer-->
            <div class="modal-footer">
                <div class="col-sm-2 col-md-2">
                    <div class="row">
                        <button class="btn btn-default itens" type="submit" style="height:62px;">
                            <div class="row"><i class="fa-solid fa-pen-to-square"></i></div>
                            Itens
                        </button>
                    </div>
                </div>
                <div class="col-sm-2 col-md-2">
                    <div class="row">
                        <button class="btn btn-default" type="submit" style="height:62px;">
                            <div class="row"><i class="fa-regular fa-clock"></i></div>
                            Histórico
                        </button>
                    </div>
                </div>
                <div class="col-sm-2 col-md-2">
                    <div class="row">
                        <button class="btn btn-default anexos" type="submit" style="height:62px;">
                            <div class="row"><i class="fa-regular fa-file"></i></div>
                            Anexos
                        </button>
                    </div>
                </div>
                <div class="col-sm-2 col-md-2">
                    <button class="btn btn-default" type="submit" id="SolicitarCotacao">
                        <i class="fa-solid fa-paper-plane"></i>
                        Solicitar Cotação
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Itens-->
<div class="modal fade" id="itens-modal" role="dialog" tabindex="-1" aria-labelledby="demo-itens-modal" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-1">
                    <a class="closeItens" data-dismiss="modal"><i class="fa-regular fa-circle-xmark" style="color:red"></i></a>
                </div>
            </div>

            <!--Modal body-->
            <div class="modal-body">
                <div class="row">
                    <div class="card" style="padding:10px;">
                        <input hidden id="IdItens" />
                        <div class="panel">
                            <div class="panel-body">
                                <table id="Produto" name="Produto" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                    <thead>
                                        <tr>
                                            <th class="text-center">
                                                Item
                                            </th>
                                            <th class="text-center">
                                                Licit.
                                            </th>
                                            <th class="text-center">
                                                Produto
                                            </th>
                                            <th class="text-center">
                                                Tuss
                                            </th>
                                            <th class="text-center">
                                                Anvisa
                                            </th>
                                            <th class="text-center">
                                                Marca
                                            </th>
                                            <th class="text-center">
                                                Qtd.
                                            </th>
                                            <th class="text-center">
                                                UM
                                            </th>
                                            <th class="text-center">
                                                Prc. Unit.
                                            </th>
                                            <th class="text-center">
                                                Vlr.Total
                                            </th>
                                            <th class="text-center">
                                                Tp. Op.
                                            </th>
                                            <th class="text-center">
                                                Lote
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Anexos-->
<div class="modal fade" id="anexos-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-1">
                    <a class="closeDados" data-dismiss="modal"><i class="fa-regular fa-circle-xmark" style="color:red"></i></a>
                </div>
            </div>

            <!--Modal body-->
            <div class="modal-body">
                <div id="AnexosLista" class="col-md-12">
                </div>
            </div>
        </div>
    </div>
</div>

<!--Envio-->
<div class="modal fade" id="envio-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-1">
                    <a class="closeDados" data-dismiss="modal"><i class="fa-regular fa-circle-xmark" style="color:red"></i></a>
                </div>
            </div>

            <!--Modal body-->
            <div class="modal-body">
                <h2 style="color:green;">Enviado para cotação</h2>
            </div>
        </div>
    </div>
</div>

<!--Rejeicao-->
<div class="modal fade" id="rejeicao-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-12">
                    <h4>Selecionar Produto</h4>
                </div>
            </div>

            <!--Modal body-->
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <input hidden id="RejeicaoId" name="RejeicaoId" />
                        <label>Motivo</label>
                        <select type="text" class="form-control" id="MotRejeicao" name="MotRejeicao">
                            @foreach (var data in Model.Rejeicoes)
                            {
                                <option value="@data.Motivo">@data.Motivo</option>
                            }
                        </select>
                    </div>
                    <br />
                    <div class="col-md-12">
                        <label>Observação</label>
                        <textarea type="text" class="form-control" id="ObsRejeicao" name="ObsRejeicao">
                        </textarea>
                    </div>
                </div>
            </div>

            <!--Modal footer-->
            <div class="modal-footer">
                <div class="col-md-12">
                    <button class="btn btn-button btn-success float-end" onclick="recusa(1)">
                        OK
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Loading-->
<div class="modal fade" id="loading-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!--Modal body-->
            <div class="modal-body">
                <div style="display:flex; justify-content: center;">
                    <i class="fa-solid fa-spinner fa-10x fa-spin-pulse"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Descricao-->
<div class="modal fade" id="descricao-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-1">
                    <a class="close" data-dismiss="modal"><i class="fa-regular fa-circle-xmark" style="color:red"></i></a>
                </div>
            </div>
            <!--Modal body-->
            <div class="modal-body">
                <div class="row">
                    <div class="card" style="padding:10px;">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="form-group col-md-3">
                                    <label class="Label">Empresa</label>
                                    <select class="form-control" id="Empresa" name="Empresa">
                                        <option value="03">Denuo</option>
                                        <option value="01">Intermedic</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Cliente Faturamento</label>
                                    <input class="form-control" id="Cliente" name="Cliente" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Condições de Pagto.</label>
                                    <input type="text" class="form-control" id="CondPag" name="CondPag" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Tabela (R$)</label>
                                    <input class="form-control" id="Tabela" name="Tabela" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Médico</label>
                                    <input type="text" class="form-control" id="Medico" name="Medico" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Vendedor</label>
                                    <input type="text" class="form-control" id="Vendedor" name="Vendedor" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Matricula</label>
                                    <input type="text" class="form-control" id="Matricula" name="Matricula" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Paciente</label>
                                    <input type="text" class="form-control" id="Paciente" name="Paciente" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-3">
                                    <label class="Label">Hospital</label>
                                    <input type="text" class="form-control" id="Hospital" name="Hospital" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Convênio</label>
                                    <input type="text" class="form-control" id="Convenio" name="Convenio" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Instrumentador</label>
                                    <input class="form-control" id="Instrumentador" name="Instrumentador" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Procedimento</label>
                                    <input class="form-control" id="Procedimento" name="Procedimento" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-2">
                                    <label class="Label">Autorizado ?</label>
                                    <select class="form-control" id="Autorizado" name="Autorizado">
                                        <option value="1">SIM</option>
                                        <option value="2">NÃO</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-2">
                                    <label class="Label">Data Cirurgia</label>
                                    <input type="text" class="form-control" id="DataAgendamento" name="DataAgendamento" />
                                </div>
                                <div class="form-group col-md-2">
                                    <label class="Label">Data Autorização</label>
                                    <input type="text" class="form-control" id="DataAutorizacao" name="DataAutorizacao" />
                                </div>
                                <div class="form-group col-md-2">
                                    <label style="font-size:10px;">Nº Autorização</label>
                                    <input type="text" class="form-control" id="NumAutorizacao" name="NumAutorizacao" />
                                </div>
                                <div class="form-group col-md-2">
                                    <label class="Label">Senha</label>
                                    <input type="text" class="form-control" id="Senha" name="Senha" />
                                </div>
                                <div class="form-group col-md-2">
                                    <label class="Label">Tipo</label>
                                    <select class="form-control" id="Tipo" name="Tipo">
                                        <option value="5">AUTARQUIA</option>
                                        <option value="4">PERMANENTE</option>
                                        <option value="2">ELETIVA</option>
                                        <option value="3">EMERGENCIA</option>
                                        <option value="1">URGENTE</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-12">
                                    <label class="Label">Observação</label>
                                    <input type="text" class="form-control" id="Obs" name="Obs" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Modal footer-->
                <div class="modal-footer" style="padding-left:20px;">
                    <div class="panel">
                        <div class="panel-body">
                            <table id="Produto" name="Produto" class="table-striped table-bordered" cellspacing="0" width="100%">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            Item
                                        </th>
                                        <th class="text-center">
                                            Licit.
                                        </th>
                                        <th class="text-center">
                                            Produto
                                        </th>
                                        <th class="text-center">
                                            Tuss
                                        </th>
                                        <th class="text-center">
                                            Anvisa
                                        </th>
                                        <th class="text-center">
                                            Marca
                                        </th>
                                        <th class="text-center">
                                            Qtd.
                                        </th>
                                        <th class="text-center">
                                            UM
                                        </th>
                                        <th class="text-center">
                                            Prc. Unit.
                                        </th>
                                        <th class="text-center">
                                            Vlr.Total
                                        </th>
                                        <th class="text-center">
                                            Tp. Op.
                                        </th>
                                        <th class="text-center">
                                            Lote
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="panel">
                        <div class="panel-body">
                            <table id="Patrimonio" name="Patrimonio" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            Descri
                                        </th>
                                        <th class="text-center">
                                            KitBas
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Visualizar-->
<div class="modal fade" id="motivorej-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-12">
                    <h4>Motivo Rejeição</h4>
                </div>
            </div>

            <!--Modal body-->
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <label>Motivo</label>
                        <div id="MotivoRej"></div>
                    </div>
                    <br />
                    <div class="col-md-12">
                        <label>Observação</label>
                        <div id="ObsPorQ"></div>
                    </div>
                </div>
            </div>

            <!--Modal footer-->
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

<!--Duplicar-->
<div class="modal fade" id="duplicar-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-12">
                    <h4>Duplicar pedido ?</h4>
                </div>
            </div>

            <!--Modal body-->
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <input hidden id="AgendamentoDupliId" name="AgendamentoDupliId" />
                        <label>Motivo</label>
                        <div>Tem certeza que deseja fazer isso ?</div>
                    </div>
                    <br />
                </div>
            </div>

            <!--Modal footer-->
            <div class="modal-footer">
                <div class="col-md-12">
                    <button class="btn btn-button btn-success float-end" onclick="Duplic(1)">
                        OK
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        $(function () {
            $('a.details').on('click', function () {
                //$('.modal-body').load(`/masterdetails/product?id=${$(this).data('id')}`);
                var id = $(this).data('id')
                $("#IdDados").val(id);
                $("#IdItens").val(id);
                $("#Idd").val(id);
                var chamadaUrl = `/dashboards/dashboard/0?handler=dados&&agenda=${id}`
                $.ajax({
                    url: chamadaUrl,
                    type: "GET",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {
                        $('#NumCota').html(id)
                        $('#DataCriacao').html(data.dataCriacao);

                        if (data.statusPedido == 0) {
                            $('#Status').html("Sem Cotação")
                        }
                        else if (data.statusPedido == 1) {
                            $('#Status').html("Ag. Cotação")
                        }
                        else {
                            $('#Status').html("Enviado Cotação")
                        }

                        setTimeout(function () {
                            $('#details-modal').modal('show')
                        }, 2000)
                    }
                })

            });

            $('a.close').on('click', function () {
                $('#details-modal').modal('hide')
                $('#dados-modal').modal('hide')
                $('#envio-modal').modal('hide')
                $('#itens-modal').modal('hide')
                $('#rejeicao-modal').modal('hide')
                $('#loading-modal').modal('hide')
                $('#descricao-modal').modal('hide')
                $('#duplicar-modal').modal('hide')
            })

            $('button.itens').on('click', function () {
                //$('.modal-body').load(`/masterdetails/product?id=${$(this).data('id')}`);

                var id = $("#IdItens").val();
                var chamadaUrl = `/dashboards/dashboard/0?handler=itens&&agenda=${id}`
                $.ajax({
                    url: chamadaUrl,
                    type: "GET",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {

                        var produtos = data;
                        setTimeout(function () {
                            $('#loading-modal').modal('hide');
                        }, 2000)


                        $("#Produto>tbody>tr").detach()
                        produtos.forEach(function (produto) {
                            var linha = `  <tr>
                                                      <td>${produto.item}</td>
                                                      <td>${produto.licit}</td>
                                                      <td>${produto.produtos}</td>
                                                      <td>${produto.tuss}</td>
                                                      <td>${produto.anvisa}</td>
                                                      <td>${produto.marca}</td>
                                                      <td>${produto.und}</td>
                                                      <td>${produto.prcUnid}</td>
                                                      <td>${produto.segUnd}</td>
                                                      <td>${produto.tipoOp}</td>
                                                      <td>${produto.vlrTotal}</td>
                                                      <td>${produto.lote}</td>
                                                  </tr>
                                                  `;
                            $("#Produto>tbody").append(linha);
                        })

                        setTimeout(function () {
                            $('#itens-modal').modal('show')
                        }, 2000)

                    }
                })

            });

            $('a.closeItens').on('click', function () {
                $('#dados-modal').modal('hide')
                $('#envio-modal').modal('hide')
                $('#itens-modal').modal('hide')
                $('#rejeicao-modal').modal('hide')
            })

            $("button.anexos").on('click', function (e) {
                $('#anexos-modal').modal('show')
                var id = $("#Idd").val()
                console.log(id)
                var chamadaUrl = `/dashboards/dashboard/0?handler=Anexos&&agenda=${id}`
                $.ajax({
                    url: chamadaUrl,
                    type: "POST",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {
                        console.log(data)
                        data.forEach(function (anexo) {
                            console.log(anexo)
                            var linha = `<a href="/AnexosAgendamento/${anexo.anexoCam}">
                                                    <i class="fa-solid fa-file-lines fa-3x"></i>
                                                  </a>`;
                            $("#AnexosLista").append(linha);
                        })

                    }
                })
            });

            $("#searchInput").keyup(function () {
                var rows = $("#demo-dt-addrow").find("tr").hide();
                if (this.value.length) {
                    var data = this.value.split(" ");
                    $.each(data, function (i, v) {
                        rows.filter(":contains('" + v + "')").show();
                    });
                } else rows.show();
            });

            $("#SolicitarCotacao").on('click', function (e) {
                $('#envio-modal').modal('show')
                var id = $("#Idd").val()
                console.log(id)
                var chamadaUrl = `/dashboards/dashboard/0?handler=Status&&agenda=${id}`
                $.ajax({
                    url: chamadaUrl,
                    type: "POST",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {

                        location.reload();
                    }
                })
            })

            $("a.rejeicao").on('click', function () {
                var id = $(this).data('id')
                $("#RejeicaoId").val(id)
                $('#rejeicao-modal').modal('show')
            })

            aceite = function (id) {
                //$('.modal-body').load(`/masterdetails/product?id=${$(this).data('id')}`);

                var chamadaUrl = `/dashboards/dashboard/0?handler=AceitarPedido&&AgendamentoId=${id}`
                $.ajax({
                    url: chamadaUrl,
                    type: "POST",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {

                        location.reload();

                    }
                })
                return true;
            };

            dados = function (id) {

                $('#loading-modal').modal('show');
                var chamadaUrl = `/cirurgias/agendamentos?handler=details&&id=${id}`
                $.ajax({
                    url: chamadaUrl,
                    type: "GET",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {


                        $("#Empresa").val(data.agendamento.empresa);
                        $("#Tipo").val(data.agendamento.tipo);
                        $("#Cliente").val(data.agendamento.cliente);
                        $("#CondPag").val(data.agendamento.condPag);
                        $("#Tabela").val(data.agendamento.tabela);
                        $("#Vendedor").val(data.agendamento.vendedor);
                        $("#Medico").val(data.agendamento.medico);
                        $("#Hospital").val(data.agendamento.hospital)
                        $("#Matricula").val(data.agendamento.matricula);
                        $("#Paciente").val(data.agendamento.paciente);
                        $("#Convenio").val(data.agendamento.convenio);
                        $("#Instrumentador").val(data.agendamento.instrumentador);
                        $("#DataAgendamento").val(data.agendamento.dataCirurgia);
                        $("#DataAutorizacao").val(data.agendamento.dataAutorizacao);
                        $("#NumAutorizacao").val(data.agendamento.numAutorizacao);
                        $("#Procedimento").val(data.agendamento.procedimento)
                        $("#Senha").val(data.agendamento.senha);
                        $("#Obs").val(data.agendamento.observacao);
                        $("#Autorizado").val(data.agendamento.autorizado)

                        var produtos = data.produtos;
                        var patris = data.patris;
                        setTimeout(function () {
                            $('#loading-modal').modal('hide');
                        }, 2000)


                        $("#Produto>tbody>tr").detach()
                        produtos.forEach(function (produto) {
                            var linha = `
                                        <tr>
                                            <td>${produto.item}</td>
                                            <td>${produto.licit}</td>
                                            <td>${produto.produtos}</td>
                                            <td>${produto.tuss}</td>
                                            <td>${produto.anvisa}</td>
                                            <td>${produto.marca}</td>
                                            <td>${produto.und}</td>
                                            <td>${produto.prcUnid}</td>
                                            <td>${produto.segUnd}</td>
                                            <td>${produto.tipoOp}</td>
                                            <td>${produto.vlrTotal}</td>
                                            <td>${produto.lote}</td>
                                        </tr>
                                        `;
                            $("#Produto>tbody").append(linha);
                        })

                        $("#Patrimonio>tbody>tr").detach()
                        patris.forEach(function (patri) {
                            var linha = `<tr>
                                            <td> ${patri.descri}</td>
                                            <td> ${patri.kitBas}</td>
                                         </tr>`
                            $("#Patrimonio>tbody").append(linha);
                        })


                        setTimeout(function () {
                            $('#descricao-modal').modal('show');
                        }, 2000)

                    }
                })
            }

        })
    </script>
    <script>
        recusa = function (num) {
            //$('.modal-body').load(`/masterdetails/product?id=${$(this).data('id')}`);

            var id = $("#RejeicaoId").val();
            var Motivo = $("#MotRejeicao").val();
            var Obs = $("#ObsRejeicao").val();

            console.log(id)
            console.log(Motivo)
            console.log(Obs)

            var chamadaUrl = `/dashboards/dashboard/0?handler=RecusarPedido&&AgendamentoId=${id}&&MotivoReij=${Motivo}&&ObsReij=${Obs}`
            $.ajax({
                url: chamadaUrl,
                type: "POST",
                contentType: "application/json;",
                dataType: 'json',
                headers: {
                    "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                },
                success: function (data) {

                    location.reload();

                }
            })
            return true;
        };
    </script>
    <script>
        $(function () {
            $("a.MotivoRej").on('click', function () {
                var id = $(this).data('id')

                var chamadaUrl = `/dashboards/dashboard/0?handler=RecusaPedido&&AgendamentoId=${id}`
                $.ajax({
                    url: chamadaUrl,
                    type: "GET",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {


                        $("#MotivoRej").html(data.motivo);
                        $("#ObsPorQ").html(data.obs);
                        $('#motivorej-modal').modal('show')

                    }
                })
            })
        })
    </script>
    <script>
        $(function () {
            $("a.duplicar").on('click', function () {
                var id = $(this).data('id')
                $("#AgendamentoDupliId").val(id)
                $('#duplicar-modal').modal('show')
            })
        })

        Duplic = function (num) {
            //$('.modal-body').load(`/masterdetails/product?id=${$(this).data('id')}`);

            var id = $("#AgendamentoDupliId").val();

            var chamadaUrl = `/dashboards/dashboard/0?handler=DuplicarPedido&&AgendamentoId=${id}`
            $.ajax({
                url: chamadaUrl,
                type: "POST",
                contentType: "application/json;",
                dataType: 'json',
                headers: {
                    "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                },
                success: function (data) {

                    location.reload();

                }
            })
            return true;
        };
    </script>
    <script type="text/javascript">


        google.charts.load('current', { 'packages': ['corechart'] });
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {

            var data = google.visualization.arrayToDataTable([
                ['Task', 'Hours per Day'],
                ['Work', 20],
                ['Eat', 20],
                ['Commute', 20],
                ['Watch TV', 20],
                ['Sleep', 20],
            ]);

            var options = {
                title: 'My Daily Activities'
            };

            var chart = new google.visualization.PieChart(document.getElementById('piechart'));

            chart.draw(data, options);
        }

    </script>
}
