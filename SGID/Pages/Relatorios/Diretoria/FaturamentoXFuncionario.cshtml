@page
@model SGID.Pages.Relatorios.Diretoria.FaturamentoXFuncionarioModel
@{
    ViewData["Title"] = "Faturamento X Funcionario";
    if (User.IsInRole("Diretoria") && !User.IsInRole("Admin"))
    {
        Layout = "_LayoutDiretoria";
    }
    else
    {
        Layout = "_LayoutNovo";
    }
}

@using (@Html.BeginForm(FormMethod.Post))
{
    <div class="row">
        <div class="form-group mx-sm-3 mb-2 col-lg-2">
            <label>Mês</label>
            <input type="text" class="form-control" id="Mes" name="Mes" placeholder="Mês" value="@Model.Mes" />
        </div>
        <div class="form-group mx-sm-3 mb-2 col-lg-2">
            <label>Ano</label>
            <input type="text" class="form-control" id="Ano" name="Ano" placeholder="Ano" value="@Model.Ano" />
        </div>
        <div class="form-group mx-sm-3 mb-2 col-lg-2">
            <label>Empresa</label>
            <select type="text" class="form-control" id="Empresa" name="Empresa">
                <option value="">TODOS...</option>
                <option value="DENUO">DENUO</option>
                <option value="INTERMEDIC">INTERMEDIC</option>
            </select>
        </div>
        <div class="form-group mx-sm-3 mb-2 col-lg-2">
            <label>Linhas</label>
            <select type="text" class="form-control" id="Linha" name="Linha">
                <option value="">TODOS...</option>
                <option value="ORTOPEDIA">ORTOPEDIA</option>
                <option value="INTERIOR">INTERIOR</option>
                <option value="LICITACOES">LICITAÇÕES</option>
                <option value="SUB">SUB-DISTRIBUIDOR</option>
                <option value="BUCO">BUCOMAXILO</option>
                <option value="TORAX">TORAX</option>
                <option value="DENTAL">BUCOMAXILO</option>
                <option value="ADMINISTRATIVO">ADMINISTRATIVO</option>
            </select>
        </div>
        <div class="form-group mx-sm-3 mb-2 col-lg-1">
            <label></label>
            <button type="submit" class="btn btn-primary mb-2">Pesquisar</button>
        </div>
        <div class="form-group mx-sm-3 mb-2 col-lg-1">
            <button type="submit" class="btn btn-secondary mb-2" asp-page-handler="Export"><i class="fa-solid fa-file-excel"></i> Exportar Excel</button>
        </div>
    </div>
}


<div class="panel">
    <div class="panel-body">
        <table id="demo-dt-addrow" class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th class="text-center">
                        Nome
                    </th>
                    <th class="text-center">
                        Mês/Ano
                    </th>
                    <th class="text-center">
                        Faturamento Mes
                    </th>
                    <th class="text-center">
                        Recebimento Mes
                    </th>
                    <th class="text-center">
                        Meta Mensal
                    </th>
                    <th class="text-center">
                        Atingimento Meta
                    </th>
                    <th class="text-center">
                        Salario Base
                    </th>
                    <th class="text-center">
                        Garantia
                    </th>
                    <th class="text-center">
                        Comissão Vendedor
                    </th>
                    <th class="text-center">
                        Comissão Equipe
                    </th>
                    <th class="text-center">
                        Total Bruto Remuneração
                    </th>
                    <th class="text-center">
                        Teto
                    </th>
                    <th class="text-center">
                        Total Geral
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.UsuariosLicitacoes)
                {
                    <tr>
                        <td><a style="text-decoration: none;" target="_blank" href="/account/rh/RelatorioComissao?IdTime=@item.User.Id&&Mes=@Model.Mes&&Ano=@Model.Ano">@item.User.Integrante.ToUpper().Split("@")[0].Replace(".", " ")</a></td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}",item.Faturado)</td>
                        <td>@string.Format("{0:N2}",item.Meta)</td>
                        <td>
                            @if (item.Meta > 0)
                            {
                                <span>@string.Format("{0:N2}", item.MetaAtingimento)</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}",item.Salario)</td>
                        <td>@string.Format("{0:N2}",item.Garantia)</td>
                        <td>@string.Format("{0:N2}",item.Comissao)</td>
                        <td>@string.Format("{0:N2}",item.ComissaoEquipe + item.ComissaoProduto)</td>
                        <td>@string.Format("{0:N2}",item.Total)</td>
                        <td>@string.Format("{0:N2}",item.Teto)</td>
                        <td>@string.Format("{0:N2}",item.Paga)</td>
                    </tr>
                }

                @if (Model.UsuariosLicitacoes.Count > 0)
                {
                    <tr style="background-color:#808080;color:white">
                        <td>LICITAÇÕES</td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosLicitacoes.Sum(x => x.Faturado))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosLicitacoes.Sum(x => x.Meta))</td>
                        <td>@if(Model.UsuariosLicitacoes.Sum(x => x.Meta) > 0)
                            {
                                <span>@string.Format("{0:N2}", ((Model.UsuariosLicitacoes.Sum(x => x.Faturado) / Model.UsuariosLicitacoes.Sum(x => x.Meta)) * 100))</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}", Model.UsuariosLicitacoes.Sum(x => x.Salario))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosLicitacoes.Sum(x => x.Garantia))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosLicitacoes.Sum(x => x.Comissao))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosLicitacoes.Sum(x => x.ComissaoEquipe) + Model.UsuariosLicitacoes.Sum(x => x.ComissaoProduto))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosLicitacoes.Sum(x => x.Total))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosLicitacoes.Sum(x => x.Teto))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosLicitacoes.Sum(x => x.Paga))</td>
                    </tr>
                }
           
                @foreach (var item in Model.UsuariosSub)
                {
                    <tr>
                        <td><a style="text-decoration: none;" target="_blank" href="/account/rh/RelatorioComissao?IdTime=@item.User.Id&&Mes=@Model.Mes&&Ano=@Model.Ano">@item.User.Integrante.ToUpper().Split("@")[0].Replace(".", " ")</a></td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}",item.Faturado)</td>
                        <td>@string.Format("{0:N2}",item.Meta)</td>
                        <td>
                            @if (item.Meta > 0)
                            {
                                <span>@string.Format("{0:N2}", item.MetaAtingimento)</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}",item.Salario)</td>
                        <td>@string.Format("{0:N2}",item.Garantia)</td>
                        <td>@string.Format("{0:N2}",item.Comissao)</td>
                        <td>@string.Format("{0:N2}",item.ComissaoEquipe + item.ComissaoProduto)</td>
                        <td>@string.Format("{0:N2}",item.Total)</td>
                        <td>@string.Format("{0:N2}",item.Teto)</td>
                        <td>@string.Format("{0:N2}",item.Paga)</td>
                    </tr>
                }

                @if (Model.UsuariosSub.Count > 0)
                {
                    <tr style="background-color:#808080;color:white">
                        <td>SUB-DISTRIBUIDOR</td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosSub.First().Faturado)</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Meta))</td>
                        <td>@if(Model.UsuariosSub.Sum(x => x.Meta) > 0)
                            {
                                <span>@string.Format("{0:N2}", ((Model.UsuariosSub.First().Faturado / Model.UsuariosSub.Sum(x => x.Meta)) * 100))</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                            </td>
                        <td>@string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Salario))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Garantia))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Comissao))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.ComissaoEquipe) + Model.UsuariosSub.Sum(x => x.ComissaoProduto))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Total))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Teto))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Paga))</td>
                    </tr>
                }

                @foreach (var item in Model.ComercialOrtopedia)
                {
                    <tr>
                        <td><a style="text-decoration: none;" target="_blank" href="/account/rh/RelatorioComissao?IdTime=@item.User.Id&&Mes=@Model.Mes&&Ano=@Model.Ano">@item.User.Integrante.ToUpper().Split("@")[0].Replace(".", " ")</a></td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}",item.Faturado)</td>
                        <td>@string.Format("{0:N2}",item.Baixa)</td>
                        <td>@string.Format("{0:N2}",item.Meta)</td>
                        <td>
                            @if (item.Meta > 0)
                            {
                                <span>@string.Format("{0:N2}", item.MetaAtingimento)</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}",item.Salario)</td>
                        <td>@string.Format("{0:N2}",item.Garantia)</td>
                        <td>@string.Format("{0:N2}",item.Comissao)</td>
                        <td>@string.Format("{0:N2}",item.ComissaoEquipe + item.ComissaoProduto)</td>
                        <td>@string.Format("{0:N2}",item.Total)</td>
                        <td>@string.Format("{0:N2}",item.Teto)</td>
                        <td>@string.Format("{0:N2}",item.Paga)</td>
                    </tr>
                }

                @if (Model.ComercialOrtopedia.Count > 0)
                {
                    <tr style="background-color:#808080;color:white">
                        <td>ORTOPEDIA</td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Faturado))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Baixa))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Meta))</td>
                        <td>
                            @if(Model.ComercialOrtopedia.Sum(x => x.Meta)>0)
                            {
                                <span>@string.Format("{0:N2}", ((Model.ComercialOrtopedia.Sum(x => x.Faturado) / Model.ComercialOrtopedia.Sum(x => x.Meta)) * 100))</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Salario))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Garantia))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Comissao))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.ComissaoEquipe) + Model.ComercialOrtopedia.Sum(x => x.ComissaoProduto))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Total))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Teto))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Paga))</td>
                    </tr>
                }

                @foreach (var item in Model.ComercialBuco)
                {
                    <tr>
                        <td><a style="text-decoration: none;" target="_blank" href="/account/rh/RelatorioComissao?IdTime=@item.User.Id&&Mes=@Model.Mes&&Ano=@Model.Ano">@item.User.Integrante.ToUpper().Split("@")[0].Replace(".", " ")</a></td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}",item.Faturado)</td>
                        <td>@string.Format("{0:N2}", item.Baixa)</td>
                        <td>@string.Format("{0:N2}",item.Meta)</td>
                        <td>
                            @if (item.Meta > 0)
                            {
                                <span>@string.Format("{0:N2}", item.MetaAtingimento)</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}",item.Salario)</td>
                        <td>@string.Format("{0:N2}",item.Garantia)</td>
                        <td>@string.Format("{0:N2}",item.Comissao)</td>
                        <td>@string.Format("{0:N2}",item.ComissaoEquipe + item.ComissaoProduto)</td>
                        <td>@string.Format("{0:N2}",item.Total)</td>
                        <td>@string.Format("{0:N2}",item.Teto)</td>
                        <td>@string.Format("{0:N2}",item.Paga)</td>
                    </tr>
                }

                @if (Model.ComercialBuco.Count > 0)
                {
                    <tr style="background-color:#808080;color:white">
                        <td>BUCOMAXILO</td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.Faturado))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.Baixa))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.Meta))</td>
                        <td>@if(Model.ComercialBuco.Sum(x => x.Meta)>0)
                            {
                                <span>@string.Format("{0:N2}", ((Model.ComercialBuco.Sum(x => x.Faturado) / Model.ComercialBuco.Sum(x => x.Meta)) * 100))</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                            </td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.Salario))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.Garantia))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.Comissao))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.ComissaoEquipe) + Model.ComercialBuco.Sum(x => x.ComissaoProduto))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.Total))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.Teto))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialBuco.Sum(x => x.Paga))</td>
                    </tr>
                }

                @foreach (var item in Model.ComercialTorax)
                {
                    <tr>
                        <td><a style="text-decoration: none;" target="_blank" href="/account/rh/RelatorioComissao?IdTime=@item.User.Id&&Mes=@Model.Mes&&Ano=@Model.Ano">@item.User.Integrante.ToUpper().Split("@")[0].Replace(".", " ")</a></td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}",item.Faturado)</td>
                        <td>@string.Format("{0:N2}",item.Baixa)</td>
                        <td>@string.Format("{0:N2}",item.Meta)</td>
                        <td>
                            @if (item.Meta > 0)
                            {
                                <span>@string.Format("{0:N2}", item.MetaAtingimento)</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}",item.Salario)</td>
                        <td>@string.Format("{0:N2}",item.Garantia)</td>
                        <td>@string.Format("{0:N2}",item.Comissao)</td>
                        <td>@string.Format("{0:N2}",item.ComissaoEquipe + item.ComissaoProduto)</td>
                        <td>@string.Format("{0:N2}",item.Total)</td>
                        <td>@string.Format("{0:N2}",item.Teto)</td>
                        <td>@string.Format("{0:N2}",item.Paga)</td>
                    </tr>
                }

                @if (Model.ComercialTorax.Count > 0)
                {
                    <tr style="background-color:#808080;color:white">
                        <td>TORAX</td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.Faturado))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.Baixa))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.Meta))</td>
                        <td>@if(Model.ComercialTorax.Sum(x => x.Meta) > 0)
                            {
                                <span>@string.Format("{0:N2}", ((Model.ComercialTorax.Sum(x => x.Faturado) / Model.ComercialTorax.Sum(x => x.Meta)) * 100))</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                            </td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.Salario))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.Garantia))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.Comissao))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.ComissaoEquipe) + Model.ComercialBuco.Sum(x => x.ComissaoProduto))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.Total))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.Teto))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialTorax.Sum(x => x.Paga))</td>
                    </tr>
                }

                @foreach (var item in Model.ComercialInterior)
                {
                    <tr>
                        <td><a style="text-decoration: none;" target="_blank" href="/account/rh/RelatorioComissao?IdTime=@item.User.Id&&Mes=@Model.Mes&&Ano=@Model.Ano">@item.User.Integrante.ToUpper().Split("@")[0].Replace(".", " ")</a></td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}",item.Faturado)</td>
                        <td>@string.Format("{0:N2}",item.Baixa)</td>
                        <td>@string.Format("{0:N2}",item.Meta)</td>
                        <td>
                            @if (item.Meta > 0)
                            {
                                <span>@string.Format("{0:N2}", item.MetaAtingimento)</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}",item.Salario)</td>
                        <td>@string.Format("{0:N2}",item.Garantia))</td>
                        <td>@string.Format("{0:N2}",item.Comissao)</td>
                        <td>@string.Format("{0:N2}",item.ComissaoEquipe + item.ComissaoProduto)</td>
                        <td>@string.Format("{0:N2}",item.Total)</td>
                        <td>@string.Format("{0:N2}",item.Teto)</td>
                        <td>@string.Format("{0:N2}",item.Paga)</td>
                    </tr>
                }

                @if (Model.ComercialInterior.Count > 0)
                {
                    <tr style="background-color:#808080;color:white">
                        <td>INTERIOR</td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.Faturado))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.Baixa))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.Meta))</td>
                        <td>@if(Model.ComercialInterior.Sum(x => x.Meta) > 0)
                            {
                                <span>@string.Format("{0:N2}", ((Model.ComercialInterior.Sum(x => x.Faturado) / Model.ComercialInterior.Sum(x => x.Meta)) * 100))</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.Salario))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.Garantia))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.Comissao))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.ComissaoEquipe) + Model.ComercialInterior.Sum(x => x.ComissaoProduto))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.Total))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.Teto))</td>
                        <td>@string.Format("{0:N2}", Model.ComercialInterior.Sum(x => x.Paga))</td>
                    </tr>
                }

                @foreach(var item in Model.UsuariosDental)
                {
                    <tr>
                        <td><a style="text-decoration: none;" target="_blank" href="/account/rh/RelatorioComissaoDental?IdTime=@item.User.Id&&Mes=@Model.Mes&&Ano=@Model.Ano">@item.User.Integrante.ToUpper().Split("@")[0].Replace(".", " ")</a></td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}",item.Faturado)</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}",item.Meta)</td>
                        <td>@if(item.Meta > 0)
                            {
                                <span>@string.Format("{0:N2}", item.MetaAtingimento)</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                        </td>
                        <td>@string.Format("{0:N2}",item.Salario)</td>
                        <td>@string.Format("{0:N2}", item.Garantia)</td>
                        <td>@string.Format("{0:N2}",item.Comissao)</td>
                        <td>@string.Format("{0:N2}",item.ComissaoEquipe)</td>
                        <td>@string.Format("{0:N2}",item.Total)</td>
                        <td>@string.Format("{0:N2}",item.Teto)</td>
                        <td>@string.Format("{0:N2}",item.Paga)</td>
                    </tr>
                }

                @if (Model.UsuariosDental.Count > 0)
                {
                    <tr style="background-color:#808080;color:white">
                        <td>DENTAL</td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosDental.Sum(x => x.Faturado))</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosDental.Sum(x => x.Meta))</td>
                        <td>@if(Model.UsuariosDental.Sum(x => x.Meta) > 0)
                            {
                                <span>@string.Format("{0:N2}", ((Model.UsuariosDental.Sum(x => x.Faturado) / Model.UsuariosDental.Sum(x => x.Meta)) * 100))</span>
                            }
                            else
                            {
                                <span>0</span>
                            }
                            </td>
                        <td>@string.Format("{0:N2}", Model.UsuariosDental.Sum(x => x.Salario))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosDental.Sum(x => x.Garantia))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosDental.Sum(x => x.Comissao))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosDental.Sum(x => x.ComissaoEquipe))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosDental.Sum(x => x.Total))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosDental.Sum(x => x.Teto))</td>
                        <td>@string.Format("{0:N2}", Model.UsuariosDental.Sum(x => x.Paga))</td>
                    </tr>
                }

                @foreach (var item in Model.Usuarios)
                {
                    <tr>
                        <td>@item.User.Integrante.ToUpper().Split("@")[0].Replace(".", " ")</td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}",item.Faturado)</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}",item.Meta)</td>
                        <td>@string.Format("{0:N2}",item.MetaAtingimento)</td>
                        <td>@string.Format("{0:N2}",item.Salario)</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}",item.Comissao)</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}",item.Total)</td>
                        <td>@string.Format("{0:N2}",item.Teto)</td>
                        <td>@string.Format("{0:N2}",item.Paga)</td>
                    </tr>
                }

                @if (Model.Usuarios.Count > 0)
                {
                    <tr style="background-color:#808080;color:white">
                        <td>ADMINISTRATIVO</td>
                        <td>@Model.Mes/@Model.Ano</td>
                        <td>@string.Format("{0:N2}", Model.Usuarios.First().Faturado)</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}", Model.Usuarios.First().Meta)</td>
                        <td>@string.Format("{0:N2}", Model.Usuarios.First().MetaAtingimento)</td>
                        <td>@string.Format("{0:N2}", Model.Usuarios.Sum(x => x.Salario))</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}", Model.Usuarios.Sum(x => x.Comissao))</td>
                        <td>0</td>
                        <td>@string.Format("{0:N2}", Model.Usuarios.Sum(x => x.Total))</td>
                        <td>@string.Format("{0:N2}", Model.Usuarios.Sum(x => x.Teto))</td>
                        <td>@string.Format("{0:N2}", Model.Usuarios.Sum(x => x.Paga))</td>
                    </tr>
                }

                <tr style="background-color:#808080;color:white">
                    <td>Total: </td>
                    <td>@Model.Mes/@Model.Ano</td>
                    <td>@string.Format("{0:N2}", Model.ComercialOrtopedia.Sum(x => x.Faturado) + Model.ComercialBuco.Sum(x => x.Faturado) + Model.ComercialTorax.Sum(x => x.Faturado) + Model.ComercialInterior.Sum(x => x.Faturado) + Model.UsuariosDental.Sum(x => x.Faturado))</td>
                    <td>@string.Format("{0:N2}", Model.UsuariosSub.FirstOrDefault()?.Faturado + Model.UsuariosLicitacoes.Sum(x => x.Faturado))</td>
                    <td></td>
                    <td></td>
                    <td>
                        @string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Salario) + Model.UsuariosLicitacoes.Sum(x => x.Salario) + Model.ComercialOrtopedia.Sum(x => x.Salario) + Model.ComercialBuco.Sum(x => x.Salario) + Model.ComercialTorax.Sum(x => x.Salario) + Model.ComercialInterior.Sum(x => x.Salario) + Model.UsuariosDental.Sum(x => x.Salario) + Model.Usuarios.Sum(x => x.Salario))
                    </td>
                    <td>
                        @string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Garantia) + Model.UsuariosLicitacoes.Sum(x => x.Garantia) + Model.ComercialOrtopedia.Sum(x => x.Garantia) + Model.ComercialBuco.Sum(x => x.Garantia) + Model.ComercialTorax.Sum(x => x.Garantia) + Model.ComercialInterior.Sum(x => x.Garantia) + Model.UsuariosDental.Sum(x => x.Garantia))
                    </td>
                    <td>@string.Format("{0:N2}", Model.UsuariosSub.Sum(x=> x.Comissao) + Model.UsuariosLicitacoes.Sum(x => x.Comissao) + Model.ComercialOrtopedia.Sum(x => x.Comissao) + Model.ComercialBuco.Sum(x => x.Comissao) + Model.ComercialTorax.Sum(x => x.Comissao) + Model.ComercialInterior.Sum(x => x.Comissao) + Model.UsuariosDental.Sum(x => x.Comissao) + Model.Usuarios.Sum(x => x.Comissao))</td>
                    <td>
                        @string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.ComissaoEquipe) + Model.UsuariosLicitacoes.Sum(x => x.ComissaoEquipe) + Model.ComercialOrtopedia.Sum(x => x.ComissaoEquipe) + Model.ComercialBuco.Sum(x => x.ComissaoEquipe) + Model.ComercialTorax.Sum(x => x.ComissaoEquipe) + Model.ComercialInterior.Sum(x => x.ComissaoEquipe) + Model.UsuariosDental.Sum(x => x.ComissaoEquipe) + Model.UsuariosSub.Sum(x => x.ComissaoProduto) + Model.UsuariosLicitacoes.Sum(x => x.ComissaoProduto) + Model.ComercialOrtopedia.Sum(x => x.ComissaoProduto) + Model.ComercialBuco.Sum(x => x.ComissaoProduto) + Model.ComercialTorax.Sum(x => x.ComissaoProduto) + Model.ComercialInterior.Sum(x => x.ComissaoProduto))
                    </td>
                    <td>
                        @string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Total) + Model.UsuariosLicitacoes.Sum(x => x.Total) + Model.ComercialOrtopedia.Sum(x => x.Total) + Model.ComercialBuco.Sum(x => x.Total) + Model.ComercialTorax.Sum(x => x.Total) + Model.ComercialInterior.Sum(x => x.Total) + Model.UsuariosDental.Sum(x => x.Total) + Model.Usuarios.Sum(x => x.Total))
                    </td>
                    <td></td>
                    <td>
                        @string.Format("{0:N2}", Model.UsuariosSub.Sum(x => x.Paga) + Model.UsuariosLicitacoes.Sum(x => x.Paga) + Model.ComercialOrtopedia.Sum(x => x.Paga) + Model.ComercialBuco.Sum(x => x.Paga) + Model.ComercialTorax.Sum(x => x.Paga) + Model.ComercialInterior.Sum(x => x.Paga) + Model.UsuariosDental.Sum(x => x.Paga) + Model.Usuarios.Sum(x => x.Paga))
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
