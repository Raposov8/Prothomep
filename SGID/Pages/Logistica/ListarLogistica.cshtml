@page "{empresa}/{id}"
@model SGID.Pages.Logistica.ListarLogisticaModel
@{
    ViewData["Title"] = "DASHBOARD";
    if (User.IsInRole("Diretoria") && !User.IsInRole("Admin"))
    {
        Layout = "_LayoutDiretoria";
    }
    else
    {
        Layout = "_LayoutNovo";
    }
}

<div class="row">
    <div class="col-md-6">
        <h4>Logística</h4>
    </div>
</div>

<!-- Cards -->
<div class="row justify-content-center col-xs-12 col-sm-12 col-md-12 col-xl-12">
    <div class="col-xs-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:green" class="panel-title text-center">APROVADAS</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                @if(Model.Empresa == "01")
                {
                    <a class="produto" href="/logistica/listarlogistica/01/1"><h3 class="text-center" style="margin-top:0%; color:green;font-size:80px">@Model.Aprovadas</h3></a>
                }
                else
                {
                    <a class="produto" href="/logistica/listarlogistica/03/1"><h3 class="text-center" style="margin-top:0%; color:green;font-size:80px">@Model.Aprovadas</h3></a>
                }
                
            </div>
        </div>
    </div>
    <div class="col-xs-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:green" class="panel-title text-center">CONFIRMADAS</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                @if (Model.Empresa == "01")
                {
                    <a class="produto" href="/logistica/listarlogistica/01/8"><h3 class="text-center" style="margin-top:0%; color:green;font-size:80px">@Model.Confirmadas</h3></a>
                }
                else
                {
                    <a class="produto" href="/logistica/listarlogistica/03/8"><h3 class="text-center" style="margin-top:0%; color:green;font-size:80px">@Model.Confirmadas</h3></a>
                }
            </div>
        </div>
    </div>
    <div class="col-xs-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:red" class="panel-title text-center">PENDENTE</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                @if (Model.Empresa == "01")
                {
                    <a class="produto" href="/logistica/listarlogistica/01/2"><h3 class="text-center" style="margin-top:0%; color:red;font-size:80px">@Model.Pendente</h3></a>
                }
                else
                {
                    <a class="produto" href="/logistica/listarlogistica/03/2"><h3 class="text-center" style="margin-top:0%; color:red;font-size:80px">@Model.Pendente</h3></a>
                }

            </div>
        </div>
    </div>
    <div class="col-xs-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:green" class="panel-title text-center">RESPOSTA COMERCIAL</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                @if (Model.Empresa == "01")
                {
                    <a class="produto" href="/logistica/listarlogistica/01/9"><h3 class="text-center" style="margin-top:0%;color:green;font-size:80px">@Model.Respostas</h3></a>
                }
                else
                {
                    <a class="produto" href="/logistica/listarlogistica/03/9"><h3 class="text-center" style="margin-top:0%;color:green;font-size:80px">@Model.Respostas</h3></a>
                }

            </div>
        </div>
    </div>
    <div class="col-xs-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:yellow" class="panel-title text-center">SEPARAÇÃO</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                @if (Model.Empresa == "01")
                {
                    <a class="produto" href="/logistica/listarlogistica/01/3"><h3 class="text-center" style="margin-top:0%; color:yellow;font-size:80px">@Model.Separacao</h3></a>
                }
                else
                {
                    <a class="produto" href="/logistica/listarlogistica/03/3"><h3 class="text-center" style="margin-top:0%; color:yellow;font-size:80px">@Model.Separacao</h3></a>
                }

            </div>
        </div>
    </div>
    <div class="col-xs-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:green" class="panel-title text-center">EM ROTA</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                @if(Model.Empresa == "01")
                {
                    <a class="produto" href="/logistica/listarlogistica/01/4"><h3 class="text-center" style="margin-top:0%;color:green;font-size:80px">@Model.EmRota</h3></a>
                }
                else
                {
                    <a class="produto" href="/logistica/listarlogistica/03/4"><h3 class="text-center" style="margin-top:0%;color:green;font-size:80px">@Model.EmRota</h3></a>
                }
                
            </div>
        </div>
    </div>
    <div class="col-xs-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:green" class="panel-title text-center">ENTREGUES</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                @if(Model.Empresa == "01")
                {
                    <a class="produto" href="/logistica/listarlogistica/01/5"><h3 class="text-center" style="margin-top:0%; color:green;font-size:80px">@Model.Entregue</h3></a>
                }
                else
                {
                    <a class="produto" href="/logistica/listarlogistica/03/5"><h3 class="text-center" style="margin-top:0%; color:green;font-size:80px">@Model.Entregue</h3></a>
                }
                
            </div>
        </div>
    </div>
    <div class="col-xs-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:red;" class="panel-title text-center">RETORNO</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                @if(Model.Empresa == "01")
                {
                    <a class="produto" href="/logistica/listarlogistica/01/6"><h3 class="text-center" style="margin-top:0%;color:red;font-size:80px">@Model.Retorno</h3></a>
                }
                else
                {
                    <a class="produto" href="/logistica/listarlogistica/03/6"><h3 class="text-center" style="margin-top:0%;color:red;font-size:80px">@Model.Retorno</h3></a>
                }
                
            </div>
        </div>
    </div>
    <div class="col-xs-3 col-sm-3 col-md-3 col-xl-3">
        <div class="panel panel-colorful" style="background-color:lightgray">
            <div class="panel-heading">
                <h2 style="margin:0%;color:yellow" class="panel-title text-center">INSPEÇÃO</h2>
            </div>
            <div class="panel-body" style="padding-top:0px;">
                @if (Model.Empresa == "01")
                {
                    <a class="produto" href="/logistica/listarlogistica/01/7"><h3 class="text-center" style="margin-top:0%; color:yellow;font-size:80px">@Model.Inspecao</h3></a>
                }
                else
                {
                    <a class="produto" href="/logistica/listarlogistica/03/7"><h3 class="text-center" style="margin-top:0%; color:yellow;font-size:80px">@Model.Inspecao</h3></a>
                }

            </div>
        </div>
    </div>
</div>

<div class="panel">
    <div class="panel-body">
        <table id="demo-dt-addrow" class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead>
                <tr style="background-color:#5b9bd5;color:white;">
                    <th class="text-center">
                        EMPRESA
                    </th>
                    <th class="text-center">
                        TC
                    </th>
                    <th class="text-center">
                        AGEND.
                    </th>
                    <th class="text-center">
                        HOSPITAL
                    </th>
                    <th class="text-center">
                        MÉDICO
                    </th>
                    <th class="text-center">
                        PACIENTE
                    </th>
                    <th class="text-center">
                        DT. CIRURGIA
                    </th>
                    <th class="text-center">
                        DT. ENTREGA
                    </th>
                    <th class="text-center">
                        REPREN.
                    </th>
                    <th class="text-center">
                        STATUS
                    </th>
                    <th class="text-center">
                        AÇÕES
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach(var Pedido in Model.Agendamentos)
                {
                    <tr>
                        <td>
                            @if (Pedido.Empresa == "01")
                            {
                                <span>INTERMEDIC</span>
                            }
                            else
                            {
                                <span>DENUO</span>
                            }
                        </td>
                        @if (Pedido.Tipo == 3)
                        {
                            <td style="background-color:green;">
                            </td>
                        }
                        else if (Pedido.Tipo == 2)
                        {
                            <td style="background-color:yellow;">
                            </td>
                        }
                        else
                        {
                            <td style="background-color:red;">
                            </td>
                        }
                        <td>@Pedido.Id</td>
                        <td>@Pedido.Hospital</td>
                        <td>@Pedido.Medico</td>
                        <td>@Pedido.Paciente</td>
                        <td>
                            @if(Pedido.DataCirurgia == null)
                            {
                               <span>NÃO HÁ REGISTRO</span>
                            }
                            else
                            {
                               <span>@Pedido.DataCirurgia.Value.ToString("dd/MM/yyyy HH:mm")</span>
                            }
                        </td>
                        <td>
                            @if (Pedido.DataEntrega == null)
                            {
                                <span>NÃO HÁ REGISTRO</span>
                            }
                            else
                            {
                                <span>@Pedido.DataEntrega.Value.ToString("dd/MM/yyyy HH:mm")</span>
                            }
                        </td>
                        <td>
                            @Pedido.Vendedor
                        </td>
                        <td>
                            @if (Pedido.StatusLogistica == 0)
                            {
                                <span>APROVADAS</span>
                            }
                            else if (Pedido.StatusLogistica == 1 )
                            {
                                <span>PENDENTE</span>
                            }
                            else if ( Pedido.StatusLogistica == 7)
                            {
                                <span>RESPONDIDO COMERCIAL</span>
                            }
                            else if (Pedido.StatusLogistica == 2)
                            {
                                <span>SEPARAÇÃO</span>
                            }
                            else if (Pedido.StatusLogistica == 3)
                            {
                                <span>EM ROTA</span>
                            }
                            else if (Pedido.StatusLogistica == 4)
                            {
                                <span>ENTREGUE</span>
                            }
                            else if (Pedido.StatusLogistica == 5)
                            {
                                <span>ESPERANDO RETORNO</span>
                            }
                            else
                            {
                                <span>ESPERANDO PARA INSPEÇÂO</span>
                            }
                        </td>
                        <td>
                            @if (Model.Empresa == "01")
                            {

                                <a href="/logistica/ChecarAgendamento/@Pedido.Id" class="fa-solid fa-truck-fast add-tooltip" style="text-decoration:none;" data-container="body" data-placement="top" data-original-title="Confirmar Cotação" aria-hidden="true"></a>
                                
                                <a href="/logistica/ListarLogistica/01/01?handler=EnviarParaRota&&IdA=@Pedido.Id"><i class="fa-solid fa-map-location-dot"></i></a>
                                <a href="/logistica/ListarLogistica/01/01?handler=EnviarParaEntregue&&IdA=@Pedido.Id"><i class="fa-solid fa-people-carry-box"></i></a>
                                <a href="/logistica/ListarLogistica/01/01?handler=EnviarParaInspecao&&IdA=@Pedido.Id"><i class="fa-solid fa-magnifying-glass-plus"></i></a>
                            }
                            else
                            {

                                <a href="/logistica/ChecarAgendamento/@Pedido.Id" class="fa-solid fa-truck-fast add-tooltip" style="text-decoration:none;" data-container="body" data-placement="top" data-original-title="Confirmar Cotação" aria-hidden="true"></a>
                                
                                <a href="/logistica/ListarLogistica/03/01?handler=EnviarParaRota&&IdA=@Pedido.Id"><i class="fa-solid fa-map-location-dot"></i></a>
                                <a href="/logistica/ListarLogistica/03/01?handler=EnviarParaEntregue&&IdA=@Pedido.Id"><i class="fa-solid fa-people-carry-box"></i></a>
                                <a href="/logistica/ListarLogistica/03/01?handler=EnviarParaInspecao&&IdA=@Pedido.Id"><i class="fa-solid fa-magnifying-glass-plus"></i></a>
                            }
                            
                            @if(Pedido.StatusLogistica == 2)
                            {
                                <a ></a>
                            }

                                <!--<i class="fa-solid fa-truck-arrow-right" style="color:green"></i>-->
                                <!--<a class="produto" href="/cirurgias/editaragendamento/@Pedido.Id"><i class="fa-solid fa-pen"></i></a>-->
                                <!--<a class="MotivoRej" data-id="@Pedido.Id"><i class="fa-solid fa-bars" style="text-decoration:none;" data-container="body" data-placement="top" data-original-title="Motivo Rejeição" aria-hidden="true"></i></a>-->

                                <!--<a class="rejeicao" data-id="@Pedido.Id"><i class="fa-regular fa-circle-xmark" style="color:red"></i></a>
                                
                                <a href="/logistica/checkagendamento/@Pedido.Id" class="details"><i class="fa-solid fa-list-check"></i></a>
                                <a href="/logistica/PickListLogistica/@Pedido.Id" target="_blank" class="details"><i class="fa-solid fa-list-check"></i></a>-->
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!--Descricao-->
<div class="modal fade" id="descricao-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-1">
                    <a class="close" data-dismiss="modal"><i class="fa-regular fa-circle-xmark" style="color:red"></i></a>
                </div>
            </div>
            <!--Modal body-->
            <div class="modal-body">
                <div class="row">
                    <div class="card" style="padding:10px;">
                        <div class="col-md-12">
                            <div class="row">
                                <input type="hidden" id="IdAgendamento" name="IdAgendamento" />
                                <div class="form-group col-md-3">
                                    <label class="Label">Empresa</label>
                                    <select class="form-control" id="Empresa" name="Empresa">
                                        <option value="03">Denuo</option>
                                        <option value="01">Intermedic</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Cliente Faturamento</label>
                                    <input class="form-control" id="Cliente" name="Cliente" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Condições de Pagto.</label>
                                    <input type="text" class="form-control" id="CondPag" name="CondPag" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Tabela (R$)</label>
                                    <input class="form-control" id="Tabela" name="Tabela" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Médico</label>
                                    <input type="text" class="form-control" id="Medico" name="Medico" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Vendedor</label>
                                    <input type="text" class="form-control" id="Vendedor" name="Vendedor" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Matricula</label>
                                    <input type="text" class="form-control" id="Matricula" name="Matricula" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Paciente</label>
                                    <input type="text" class="form-control" id="Paciente" name="Paciente" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-3">
                                    <label class="Label">Hospital</label>
                                    <input type="text" class="form-control" id="Hospital" name="Hospital" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Convênio</label>
                                    <input type="text" class="form-control" id="Convenio" name="Convenio" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Instrumentador</label>
                                    <input class="form-control" id="Instrumentador" name="Instrumentador" />
                                </div>
                                <div class="form-group col-md-3">
                                    <label class="Label">Procedimento</label>
                                    <input class="form-control" id="Procedimento" name="Procedimento" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-md-2">
                                    <label class="Label">Autorizado ?</label>
                                    <select class="form-control" id="Autorizado" name="Autorizado">
                                        <option value="1">SIM</option>
                                        <option value="2">NÃO</option>
                                    </select>
                                </div>
                                <div class="form-group col-md-2">
                                    <label class="Label">Data Cirurgia</label>
                                    <input type="text" class="form-control" id="DataAgendamento" name="DataAgendamento" />
                                </div>
                                <div class="form-group col-md-2">
                                    <label class="Label">Data Autorização</label>
                                    <input type="text" class="form-control" id="DataAutorizacao" name="DataAutorizacao" />
                                </div>
                                <div class="form-group col-md-2">
                                    <label style="font-size:10px;">Nº Autorização</label>
                                    <input type="text" class="form-control" id="NumAutorizacao" name="NumAutorizacao" />
                                </div>
                                <div class="form-group col-md-2">
                                    <label class="Label">Senha</label>
                                    <input type="text" class="form-control" id="Senha" name="Senha" />
                                </div>
                                <div class="form-group col-md-2">
                                    <label class="Label">Tipo</label>
                                    <select class="form-control" id="Tipo" name="Tipo">
                                        <option value="2">ELETIVA</option>
                                        <option value="3">EMERGENCIA</option>
                                        <option value="1">URGENTE</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">

                                <div class="form-group col-md-12">
                                    <label class="Label">Observação</label>
                                    <input type="text" class="form-control" id="Obs" name="Obs" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Modal footer-->
                <div class="modal-footer" style="padding-left:20px;">
                    <div class="panel">
                        <div class="panel-body">
                            <table id="Produto" name="Produto" class="table-striped table-bordered" cellspacing="0" width="100%">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            Item
                                        </th>
                                        <th class="text-center">
                                            Licit.
                                        </th>
                                        <th class="text-center">
                                            Produto
                                        </th>
                                        <th class="text-center">
                                            Tuss
                                        </th>
                                        <th class="text-center">
                                            Anvisa
                                        </th>
                                        <th class="text-center">
                                            Marca
                                        </th>
                                        <th class="text-center">
                                            Qtd.
                                        </th>
                                        <th class="text-center">
                                            UM
                                        </th>
                                        <th class="text-center">
                                            Prc. Unit.
                                        </th>
                                        <th class="text-center">
                                            Vlr.Total
                                        </th>
                                        <th class="text-center">
                                            Tp. Op.
                                        </th>
                                        <th class="text-center">
                                            Lote
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="panel">
                        <div class="panel-body">
                            <table id="Patrimonio" name="Patrimonio" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            Codigo
                                        </th>
                                        <th class="text-center">
                                            Descri
                                        </th>
                                        <th class="text-center">
                                            KitBas
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="panel">
                        <div class="panel-body">
                            <table id="Avulso" name="Avulso" class="table-striped table-bordered" cellspacing="0" width="100%">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            Item
                                        </th>
                                        <th class="text-center">
                                            Licit.
                                        </th>
                                        <th class="text-center">
                                            Produto
                                        </th>
                                        <th class="text-center">
                                            Tuss
                                        </th>
                                        <th class="text-center">
                                            Anvisa
                                        </th>
                                        <th class="text-center">
                                            Marca
                                        </th>
                                        <th class="text-center">
                                            Qtd.
                                        </th>
                                        <th class="text-center">
                                            Lote
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!--Modal footer-->
            <div class="modal-footer">
                <div class="col-md-12">
                    <button class="btn btn-button btn-success float-end" onclick="emrota(1)">
                        Enviar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Rejeicao-->
<div class="modal fade" id="rejeicao-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-12">
                    <h4>Selecionar Produto</h4>
                </div>
            </div>

            <!--Modal body-->
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <input hidden id="RejeicaoId" name="RejeicaoId" />
                        <label>Motivo</label>
                        <select type="text" class="form-control" id="MotRejeicao" name="MotRejeicao">
                            @foreach (var data in Model.Rejeicoes)
                            {
                                <option value="@data.Motivo">@data.Motivo</option>
                            }
                        </select>
                    </div>
                    <br />
                    <div class="col-md-12">
                        <label>Observação</label>
                        <textarea type="text" class="form-control" id="ObsRejeicao" name="ObsRejeicao">
                        </textarea>
                    </div>
                </div>
            </div>

            <!--Modal footer-->
            <div class="modal-footer">
                <div class="col-md-12">
                    <button class="btn btn-button btn-success float-end" onclick="recusa(1)">
                        OK
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Loading-->
<div class="modal fade" id="loading-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!--Modal body-->
            <div class="modal-body">
                <div style="display:flex; justify-content: center;">
                    <i class="fa-solid fa-spinner fa-10x fa-spin-pulse"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<!--Visualizar-->
<div class="modal fade" id="motivorej-modal" role="dialog" tabindex="-1" aria-labelledby="demo-default-modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!--Modal header-->
            <div class="modal-header">
                <div class="col-md-12">
                    <h4>Motivo Rejeição</h4>
                </div>
            </div>

            <!--Modal body-->
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <label>Motivo</label>
                        <div id="MotivoRej"></div>
                    </div>
                    <br />
                    <div class="col-md-12">
                        <label>Observação</label>
                        <div id="ObsPorQ"></div>
                    </div>
                </div>
            </div>

            <!--Modal footer-->
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

@section scripts{
    <script>
        $(function () {

            $('a.close').on('click', function () {
                $('#details-modal').modal('hide')
                $('#dados-modal').modal('hide')
                $('#envio-modal').modal('hide')
                $('#itens-modal').modal('hide')
                $('#rejeicao-modal').modal('hide')
                $('#motivorej-modal').modal('hide')
                $('#loading-modal').modal('hide')
                $('#descricao-modal').modal('hide')
            })

            $('a.closeItens').on('click', function () {
                $('#dados-modal').modal('hide')
                $('#envio-modal').modal('hide')
                $('#itens-modal').modal('hide')
                $('#rejeicao-modal').modal('hide')
            })

            $("#searchInput").keyup(function () {
                var rows = $("#demo-dt-addrow").find("tr").hide();
                if (this.value.length) 
                {
                    var data = this.value.split(" ");
                    $.each(data, function (i, v) {
                        rows.filter(":contains('" + v + "')").show();
                    });
                } else rows.show();
            });

            $("a.rejeicao").on('click', function () {
                var id = $(this).data('id')
                $("#RejeicaoId").val(id)
                $('#rejeicao-modal').modal('show')
            });


        })
    </script>
    <script>
        recusa = function (num) {
            //$('.modal-body').load(`/masterdetails/product?id=${$(this).data('id')}`);

            var id = $("#RejeicaoId").val();
            var Motivo = $("#MotRejeicao").val();
            var Obs = $("#ObsRejeicao").val();

            console.log(id)
            console.log(Motivo)
            console.log(Obs)

            var chamadaUrl = `/dashboard/0?handler=RecusarPedido&&AgendamentoId=${id}&&MotivoReij=${Motivo}&&ObsReij=${Obs}`
            $.ajax({
                url: chamadaUrl,
                type: "POST",
                contentType: "application/json;",
                dataType: 'json',
                headers: {
                    "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                },
                success: function (data) {

                    location.reload();

                }
            })
            return true;
        };
    </script>
    <script>
        $(function(){
            $("a.MotivoRej").on('click', function () {
                var id = $(this).data('id')
               
                var chamadaUrl = `/dashboard/0?handler=RecusaPedido&&AgendamentoId=${id}`
                $.ajax({
                    url: chamadaUrl,
                    type: "GET",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {


                        $("#MotivoRej").html(data.motivo);
                        $("#ObsPorQ").html(data.obs);
                        $('#motivorej-modal').modal('show')

                    }
                })
            })

            dados = function (id) {

                $('#loading-modal').modal('show');
                $('#IdAgendamento').val(id);
                var chamadaUrl = `/cirurgias/agendamentos?handler=details&&id=${id}`
                $.ajax({
                    url: chamadaUrl,
                    type: "GET",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {


                        $("#Empresa").val(data.agendamento.empresa);
                        $("#Tipo").val(data.agendamento.tipo);
                        $("#Cliente").val(data.agendamento.cliente);
                        $("#CondPag").val(data.agendamento.condPag);
                        $("#Tabela").val(data.agendamento.tabela);
                        $("#Vendedor").val(data.agendamento.vendedor);
                        $("#Medico").val(data.agendamento.medico);
                        $("#Hospital").val(data.agendamento.hospital)
                        $("#Matricula").val(data.agendamento.matricula);
                        $("#Paciente").val(data.agendamento.paciente);
                        $("#Convenio").val(data.agendamento.convenio);
                        $("#Instrumentador").val(data.agendamento.instrumentador);
                        $("#DataAgendamento").val(data.agendamento.dataCirurgia);
                        $("#DataAutorizacao").val(data.agendamento.dataAutorizacao);
                        $("#NumAutorizacao").val(data.agendamento.numAutorizacao);
                        $("#Procedimento").val(data.agendamento.procedimento)
                        $("#Senha").val(data.agendamento.senha);
                        $("#Obs").val(data.agendamento.observacao);
                        $("#Autorizado").val(data.agendamento.autorizado)

                        var produtos = data.produtos;
                        var patris = data.patris;
                        var avulsos = data.avulso;
                        setTimeout(function () {
                            $('#loading-modal').modal('hide');
                        }, 2000)


                        $("#Produto>tbody>tr").detach()
                        produtos.forEach(function (produto) 
                        {
                            var linha = `<tr>
                                             <td>${produto.item}</td>
                                             <td>${produto.licit}</td>
                                             <td>${produto.produtos}</td>
                                             <td>${produto.tuss}</td>
                                             <td>${produto.anvisa}</td>
                                             <td>${produto.marca}</td>
                                             <td>${produto.und}</td>
                                             <td>${produto.prcUnid}</td>
                                             <td>${produto.segUnd}</td>
                                             <td>${produto.tipoOp}</td>
                                             <td>${produto.vlrTotal}</td>
                                             <td>${produto.lote}</td>
                                         </tr>`;
                            $("#Produto>tbody").append(linha);
                        })

                        $("#Patrimonio>tbody>tr").detach()
                        patris.forEach(function (patri) {
                            var linha = `<tr>
                                            <td> ${patri.codigo}</td>
                                            <td> ${patri.descri}</td>
                                            <td> ${patri.kitBas}</td>
                                         </tr>`
                            $("#Patrimonio>tbody").append(linha);
                        })


                        $("#Avulso>tbody>tr").detach()
                        avulsos.forEach(function (produto) {
                            var linha = `
                                         <tr>
                                             <td>${produto.item}</td>
                                             <td>${produto.licit}</td>
                                             <td>${produto.produtos}</td>
                                             <td>${produto.tuss}</td>
                                             <td>${produto.anvisa}</td>
                                             <td>${produto.marca}</td>
                                             <td>${produto.und}</td>
                                             <td>${produto.lote}</td>
                                         </tr>
                                         `;
                            $("#Avulso>tbody").append(linha);
                        })


                        setTimeout(function () {
                            $('#descricao-modal').modal('show');
                        }, 2000)

                    }
                })
            }

            emrota = function (id) {

                $('#loading-modal').modal('show');
                var agendamento = $('#IdAgendamento').val();
                var chamadaUrl = `/logistica/listarlogistica/01/01?handler=Enviar&&IdA=${agendamento}`
                $.ajax({
                    url: chamadaUrl,
                    type: "GET",
                    contentType: "application/json;",
                    dataType: 'json',
                    headers: {
                        "RequestVerificationToken": $('input:hidden[name="__RequestVerificationToken"]').val()
                    },
                    success: function (data) {
                        location.reload();

                    }
                })
            }
        })
    </script>
}