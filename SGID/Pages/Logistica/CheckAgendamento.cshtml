@page "{id}"
@model SGID.Pages.Logistica.CheckAgendamentoModel
@{
    ViewData["Title"] = "Agendamento Check";
    Layout = "_LayoutGeral";

    var count = 0;
    var countPatri = 0;
    var countAvulso = 0;
}

@using (@Html.BeginForm(FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()
    <div class="row">
        <div class="card" style="padding:10px;">
            <div class="col-md-12">
                <div class="row">
                    <div class="row">
                        <div class="col-md-8">
                            <h4>CheckList</h4>
                        </div>
                        <div class="col-md-4" style="justify-content:end">
                            <div class="row">
                                <label class="col-md-5">Nome Vendedor:</label>
                                <input class="col-md-7 form-control" id="NomeVendedor" name="NomeVendedor" value="@Model.Agendamento.Vendedor" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="col-md-12 Titulo">
                                <span>DADOS DO AGENDAMENTO</span>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <input hidden id="id" name="id" value="@Model.Agendamento.Id" />
                                    <label class="col-md-12" style="font-size:12px;">Nome Paciente</label>
                                    <input class="col-md-12 form-control" id="NomePaciente" name="NomePaciente" value="@Model.Agendamento.Paciente" />
                                </div>
                                <div class="col-md-3">
                                    <label class="col-md-12" style="font-size:12px;">Nome Hospital</label>
                                    <input class="col-md-12 form-control" id="NomeHospital" name="NomeHospital" value="@Model.Agendamento.Hospital" />
                                </div>
                                <div class="col-md-3">
                                    <label class="col-md-12" style="font-size:12px;">Nome Medico</label>
                                    <input class="col-md-12 form-control" value="@Model.Agendamento.Medico" />
                                </div>
                                <div class="col-md-3">
                                    <label class="col-md-12" style="font-size:12px;">Data da Cirurgia</label>
                                    <input type="datetime-local" class="col-md-12 form-control" id="DataCirurgia" name="DataCirurgia" />
                                </div>
                                
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="row">
                                <div class="col-md-6">
                                    <label class="col-md-12" style="font-size:12px;">Procedimento</label>
                                    <input class="col-md-12 form-control" id="Procedimento" name="Procedimento" value="@Model.Agendamento.Procedimento" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="form-group col-md-12">
                            <label class="Label">Observação</label>
                        </div>
                    </div>
                    <div class="panel">
                        <div class="panel-body">
                            <table id="Produto" name="Produto" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            Usuario
                                        </th>
                                        <th class="text-center">
                                            Data
                                        </th>
                                        <th class="text-center">
                                            Observação
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var data in Model.Observacoes)
                                    {
                                        <tr>
                                            <td>
                                                @data.User.Replace("."," ").ToUpper()
                                            </td>
                                            <td>
                                                @if (data.DataCriacao.ToString("dd/MM/yyyy HH:mm:ss") == "01/01/0001 00:00:00")
                                                {
                                                    <span>@data.DataCriacao.ToString("dd/MM/yyyy HH:mm:ss")</span>
                                                }
                                                else
                                                {
                                                    <span>"NÃO HA REGISTRO"</span>
                                                }
                                            </td>
                                            <td>
                                                @data.Obs
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="col-md-12 Titulo"> PRODUTO(S)</div>
                        <div class="panel">
                            <div class="panel-body">
                                <table id="Produto" name="Produto" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                    <thead>
                                        <tr style="background-color:#5b9bd5; color:white;">
                                            <th class="text-center">
                                                Código
                                            </th>
                                            <th class="text-center">
                                                Descrição
                                            </th>
                                            <th class="text-center">
                                                Qtd.
                                            </th>
                                            <th class="text-center">
                                                Entregue?
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var data in Model.Produtos)
                                        {
                                            <tr>
                                                <td class="text-center">
                                                    @data.Item
                                                    <input type="hidden" id="Produtos[@count].Item" name="Produtos[@count].Item" value="@data.Item" />
                                                </td>
                                                <td class="text-center">
                                                    @data.Produtos
                                                    <input type="hidden" id="Produtos[@count].Produtos" name="Produtos[@count].Produtos" value="@data.Produtos" />
                                                </td>
                                                <td class="text-center">
                                                    @data.Und
                                                    <input type="hidden" id="Produtos[@count].Und" name="Produtos[@count].Und" value="@data.Und" />
                                                </td>
                                                <td class="text-center">
                                                    <input type="checkbox" id="Produtos[@count].Check" name="Produtos[@count].Check" value="@data.Check">
                                                </td>
                                            </tr>
                                            count++;
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <br />
                        <div class="col-md-12 Titulo">PATRIMONIO(S)</div>
                        <div class="panel">
                            <div class="panel-body">
                                <table id="Patrimonio" name="Patrimonio" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                    <thead>
                                        <tr style="background-color:#5b9bd5; color:white;">
                                            <th class="text-center">
                                                Descrição
                                            </th>
                                            <th class="text-center">
                                                KitBas
                                            </th>
                                            <th class="text-center">
                                                Entregue?                              
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var data in Model.Patrimonios)
                                        {
                                            <tr>
                                                <td class ="text-center">
                                                    @data.Codigo
                                                    <input type="hidden" id="Patris[@countPatri].Codigo" name="Patris[@countPatri].Codigo" value="@data.Codigo" />
                                                </td>
                                                <td class="text-center">
                                                    @data.Descri
                                                    <input type="hidden" id="Patris[@countPatri].Descri" name="Patris[@countPatri].Descri" value="@data.Descri" />
                                                </td>
                                                <td class="text-center">
                                                    @data.KitBas
                                                    <input type="hidden" id="Patris[@countPatri].KitBas" name="Patris[@countPatri].KitBas" value="@data.KitBas" />
                                                </td>
                                                <td class="text-center">
                                                    <input type="checkbox" id="Patris[@countPatri].Check" name="Patris[@countPatri].Check" value="@data.Check">
                                                </td>
                                            </tr>
                                            countPatri++;
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <br />
                        <div class="col-md-12 Titulo"> AVULSOS(S)</div>
                        <div class="panel">
                            <div class="panel-body">
                                <table id="Avulsos" name="Avulsos" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                    <thead>
                                        <tr style="background-color:#5b9bd5; color:white;">
                                            <th class="text-center">
                                                Código
                                            </th>
                                            <th class="text-center">
                                                Descrição
                                            </th>
                                            <th class="text-center">
                                                Qtd.
                                            </th>
                                            <th class="text-center">
                                                Entregue?
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var data in Model.Avulsos)
                                        {
                                            <tr>
                                                <td class="text-center">
                                                    @data.Item
                                                    <input  type="hidden" id="Avulsos[@countAvulso].Item" name="Avulsos[@countAvulso].Item" value="@data.Item" />
                                                </td>
                                                <td class="text-center">
                                                    @data.Produtos
                                                    <input  type="hidden" id="Avulsos[@countAvulso].Produtos" name="Avulsos[@countAvulso].Produtos" value="@data.Produtos" />
                                                </td>
                                                <td class="text-center">
                                                    @data.Und
                                                    <input type="hidden"  id="Avulsos[@countAvulso].Und" name="Avulsos[@countAvulso].Und" value="@data.Und" />
                                                </td>
                                                <td class="text-center">
                                                    <input type="checkbox" id="Avulsos[@countAvulso].Check" name="Avulsos[@countAvulso].Check" value="@data.Check">                                                    
                                                </td>
                                            </tr>
                                            countAvulso++;
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="row justify-content-center">
                        <div style="color:#00b050" class="col-md-2"><button class="btn btn-button btn-success float-end" style="font-size:12px;" type="submit"><i class="fa-solid fa-thumbs-up"></i> Confirmar</button></div> |
                        <div style="color:#c00000" class="col-md-2"><a class="btn btn-button btn-danger" style="font-size:12px;" href="/logistica/listarlogistica/2"><i class="fa-solid fa-xmark"></i> Cancelar</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}


@section scripts{
    <script>
        $(function(){

            @if (Model.Agendamento.DataCirurgia != null)
            {
                @:data = "@Model.Agendamento.DataCirurgia.Value.ToString("yyyy-MM-dd'T'HH:mm")"
                @:$("#DataCirurgia").val(data)
            }

            $("input[type=checkbox]").on('change',function(){

                var teste = $(this).val()

                console.log($(this).val())

                if(teste =='on')
                {
                    $(this).val(true)
                }
                else
                {
                    $(this).val(!$(this).val())
                }

                console.log($(this).val())
            })
        })
    </script>
}